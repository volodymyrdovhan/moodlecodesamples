{"version":3,"sources":["../src/private_tutoring.js"],"names":["define","$","ajax","log","Bxslider","Intellicart","PrivateTutoring","productid","container","loader","sliderbox","contentcontainer","instructoritemcontainer","instructordetailscontainer","init","document","window","on","find","removeClass","addClass","instructorid","attr","loadInstructorDetails","sid","val","getsessionstatus","parents","filter","toLowerCase","hide","each","text","indexOf","show","e","which","length","bxSlider","controls","pager","infiniteLoop","hideControlOnEnd","responsive","minSlides","maxSlides","moveSlides","slideWidth","slideMargin","shrinkItems","touchEnabled","html","call","methodname","args","day","done","response","content","id","purchased","enabledDates","JSON","parse","days","getElementById","flatpickr","dateFormat","onChange","dateObj","dateStr","disablebuybuttons","loadInstructorSessions","disable","dateObject","i","getTime","Date","Error","debug","message","fail","ex","sessionscontainer","checkoutid","sessions"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * intellicart PrivateTutoring\n *\n * @package    local_intellicart\n * @copyright  2017 SEBALE (http://sebale.net)\n */\n\ndefine(['jquery', 'core/ajax', 'core/log', 'block_products_catalog/bxslider', 'local_intellicart/intellicart'],\n    function($, ajax, log, Bxslider, Intellicart) {\n\n    var PrivateTutoring = {\n\n        productid:                  0,\n        container:                  '',\n        loader:                     '<i class=\"loader fa fa-circle-o-notch fa-spin\"></i>',\n        sliderbox:                  '.productview-instructors-box',\n        contentcontainer:           '.private-tutoring-instructors',\n        instructoritemcontainer:    '.productview-instructor-item',\n        instructordetailscontainer: '.productview-instructors-details',\n\n        init: function(productid) {\n\n            PrivateTutoring.productid = productid;\n            PrivateTutoring.container = $(PrivateTutoring.contentcontainer);\n            Bxslider.init($, document, window, undefined);\n\n            PrivateTutoring.container.on('click', PrivateTutoring.instructoritemcontainer, function() {\n                PrivateTutoring.container.find(PrivateTutoring.instructoritemcontainer).removeClass('active');\n                $(this).addClass('active');\n                var instructorid = $(this).attr('data-instructor-id');\n\n                PrivateTutoring.loadInstructorDetails(instructorid);\n            });\n\n            $(PrivateTutoring.instructordetailscontainer).on('click', '.sessions-list input[type=\"radio\"]', function() {\n                var sid = $(this).val();\n                Intellicart.getsessionstatus(productid, sid);\n                $(\".product-sessions\").find('.session-item').removeClass('open');\n                $(this).parents('.session-item').addClass('open');\n            });\n\n            $('#product_instructors').on('keyup', '#search_instructors', function() {\n                var filter = $(this).val().toLowerCase();\n\n                if (filter) {\n                    $(PrivateTutoring.instructoritemcontainer).hide();\n                    $(PrivateTutoring.instructoritemcontainer).find('.instructorname').each(function() {\n                        if($(this).text().toLowerCase().indexOf(filter) >= 0){\n                            $(this).parents(PrivateTutoring.instructoritemcontainer).show();\n                        }\n                    });\n                } else {\n                    $(PrivateTutoring.instructoritemcontainer).show();\n                }\n            });\n\n            $('#product_instructors').on('keypress', '#search_instructors', function(e) {\n                return e.which !== 13;\n            });\n\n            if ($(PrivateTutoring.sliderbox).length) {\n                $(PrivateTutoring.sliderbox).bxSlider({\n                    controls: true,\n                    pager: false,\n                    infiniteLoop: false,\n                    hideControlOnEnd: true,\n                    responsive: true,\n                    minSlides: 3,\n                    maxSlides: 3,\n                    moveSlides: 3,\n                    slideWidth: 300,\n                    slideMargin: 15,\n                    shrinkItems: true,\n                    touchEnabled: false\n                });\n            }\n        },\n\n        loadInstructorDetails: function(instructorid) {\n            $(PrivateTutoring.instructordetailscontainer).html(PrivateTutoring.loader);\n\n            ajax.call([{\n                methodname: 'local_intellicart_load_instructor_details', args: {\n                    productid: PrivateTutoring.productid,\n                    instructorid: instructorid,\n                    day: ''\n                }\n            }])[0]\n                .done(function (response) {\n                    try {\n                        $(PrivateTutoring.instructordetailscontainer).html(response.content);\n\n                        // load date filter\n                        ajax.call([{\n                            methodname: 'local_intellicart_get_product_sessions_days', args: {\n                                id: PrivateTutoring.productid,\n                                purchased: 0,\n                                instructorid: instructorid\n                            }\n                        }])[0]\n                            .done(function (response) {\n                                try {\n                                    var enabledDates = JSON.parse(response.days);\n\n                                    document.getElementById(\"instructor_session_day\").flatpickr({\n                                        dateFormat: \"Y/m/d\",\n                                        onChange: function(dateObj, dateStr) {\n                                            Intellicart.disablebuybuttons();\n                                            PrivateTutoring.loadInstructorSessions(instructorid, dateStr);\n                                        },\n                                        disable: [\n                                            function(dateObject){\n                                                for (var i = 0; i < enabledDates.length; i++) {\n                                                    if(dateObject.getTime() === new Date(enabledDates[i]).getTime()) {\n                                                        return false;\n                                                    }\n                                                }\n                                                return true;\n                                            }\n                                        ]\n                                    });\n\n                                } catch (Error) {\n                                    log.debug(Error.message);\n                                }\n                            }).fail(function (ex) {\n                            log.debug(ex.message);\n                        });\n\n                    } catch (Error) {\n                        log.debug(Error.message);\n                        $(PrivateTutoring.instructordetailscontainer).html('');\n                    }\n                }).fail(function (ex) {\n                log.debug(ex.message);\n                $(PrivateTutoring.instructordetailscontainer).html('');\n            });\n        },\n\n        loadInstructorSessions: function(instructorid, day) {\n\n            $(PrivateTutoring.instructordetailscontainer).find(Intellicart.sessionscontainer).html(Intellicart.loader);\n\n            ajax.call([{\n                methodname: 'local_intellicart_get_product_sessions_time', args: {\n                    id: PrivateTutoring.productid,\n                    day: day,\n                    purchased: 0,\n                    instructorid: instructorid,\n                    checkoutid: 0\n                }\n            }])[0]\n                .done(function (response) {\n                    try {\n                        $(PrivateTutoring.instructordetailscontainer).find(Intellicart.sessionscontainer).html(response.sessions);\n                    } catch (Error) {\n                        log.debug(Error.message);\n                    }\n                }).fail(function (ex) {\n                log.debug(ex.message);\n            });\n\n        },\n\n    };\n\n    /**\n     * @alias module:local_intellicart/private_tutoring\n     */\n    return PrivateTutoring;\n\n});"],"file":"private_tutoring.min.js"}